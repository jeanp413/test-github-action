name: SSH key
on:
  workflow_dispatch:

jobs:
  test:
    runs-on: windows-2022
    name: generate ssh key
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Install winget
        uses: Cyberboss/install-winget@v1

      - id: installssh
        run: |
          winget install "openssh" --accept-source-agreements
          ssh -V

      - run: |
          icacls .\scripts\gp_ssh_key
          icacls .\scripts\gp_ssh_key /grant:r BUILTIN\Administrators:f /inheritance:r
          icacls .\scripts\gp_ssh_key

      - id: run_script
        run: |
          type .\scripts\foo.sh
          node .\scripts\ssh.mjs

      # - id: step_set_output
      #   run: |
      #     $filename = "foo"
      #     $filepath = Join-Path $PSScriptRoot $filename
      #     ssh-keygen -t ed25519 -f $filepath -q -N ""
      #     get-content $filepath
